# Postman API 测试使用指南

## 🚀 快速开始

### 1. 导入集合和环境

1. **打开Postman**
2. **导入集合文件**: `Indian-Payment-Platform-API.postman_collection.json`
3. **导入环境文件**: `Indian-Payment-Platform-Environment.postman_environment.json`
4. **选择环境**: 在右上角选择 "Indian Payment Platform - 环境配置"

### 2. 环境配置

环境变量说明：

| 变量名 | 说明 | 默认值 |
|--------|------|--------|
| `base_url` | 线上服务器地址 | `http://13.200.72.14:3001` |
| `local_url` | 本地开发服务器地址 | `http://localhost:3001` |
| `merchant_id` | 测试商户ID | `MERCHANT_ME01UHM7` |
| `api_key` | 测试商户API密钥 | `pk_rzz8igydcme01uhm7` |
| `secret_key` | 测试商户密钥 | `sk_mxf9mdelh5me01uhm7` |

## 🔧 测试流程

### 步骤1: 测试余额查询
- 选择 "1. 余额查询" 请求
- 点击 "Send" 按钮
- 验证响应状态码和返回数据

### 步骤2: 测试存款申请
- 选择 "2. 存款申请" 请求
- 点击 "Send" 按钮
- 记录返回的订单ID（用于后续查询）

### 步骤3: 测试存款查询
- 选择 "3. 存款查询" 请求
- 使用步骤2获得的订单ID
- 点击 "Send" 按钮

### 步骤4: 测试出款申请
- 选择 "4. 出款申请" 请求
- 点击 "Send" 按钮
- 记录返回的订单ID（用于后续查询）

### 步骤5: 测试出款查询
- 选择 "5. 出款查询" 请求
- 使用步骤4获得的订单ID
- 点击 "Send" 按钮

### 步骤6: 测试UPI查询
- 选择 "6. UPI查询" 请求
- 点击 "Send" 按钮

## 🔐 签名验证机制

### 签名生成规则

1. **参数排序**: 按ASCII码从小到大排序
2. **参数过滤**: 排除 `sign` 字段和空值
3. **字符串拼接**: `key1=value1&key2=value2&...&secretKey`
4. **MD5加密**: 计算MD5散列值

### 示例

```javascript
// 原始参数
{
  "appid": "MERCHANT_ME01UHM7",
  "amount": "1000",
  "timestamp": "1756298000000"
}

// 排序后的键
["amount", "appid", "timestamp"]

// 签名字符串
"amount=1000&appid=MERCHANT_ME01UHM7&timestamp=1756298000000&sk_mxf9mdelh5me01uhm7"

// MD5签名
"生成的MD5值"
```

## 🌍 环境切换

### 测试线上环境
```bash
# 修改 base_url 为线上地址
base_url = http://13.200.72.14:3001
```

### 测试本地环境
```bash
# 修改 base_url 为本地地址
base_url = http://localhost:3001
```

## 📊 响应状态码说明

| 状态码 | 说明 |
|--------|------|
| 200 | 请求成功 |
| 400 | 请求参数错误 |
| 401 | 认证失败 |
| 500 | 服务器内部错误 |

## 🔍 常见问题

### Q1: 签名验证失败
**原因**: 签名计算错误或密钥不匹配
**解决**: 检查 `secret_key` 是否正确，确认签名算法

### Q2: 商户不存在
**原因**: `appid` 参数错误或商户未激活
**解决**: 检查 `merchant_id` 是否正确

### Q3: 网络连接失败
**原因**: 服务器未启动或端口错误
**解决**: 检查服务器状态和端口配置

## 📝 测试数据

### 测试商户信息
- **商户ID**: `MERCHANT_ME01UHM7`
- **API密钥**: `pk_rzz8igydcme01uhm7`
- **密钥**: `sk_mxf9mdelh5me01uhm7`

### 测试银行信息
- **银行代码**: `HDFC`
- **账户号码**: `1234567890`
- **IFSC代码**: `HDFC0001234`
- **账户持有人**: `Test User`

## 🎯 最佳实践

1. **按顺序测试**: 先测试基础接口，再测试依赖接口
2. **保存响应**: 记录重要的响应数据用于后续测试
3. **环境隔离**: 使用不同环境测试不同服务器
4. **错误处理**: 关注错误响应，理解失败原因
5. **数据验证**: 验证返回数据的完整性和正确性

## 📞 技术支持

如果遇到问题，请检查：
1. 服务器是否正常运行
2. 网络连接是否正常
3. 环境变量是否正确配置
4. 签名算法是否正确实现

---

**注意**: 本测试集合仅用于开发和测试环境，生产环境请使用真实的商户信息。
