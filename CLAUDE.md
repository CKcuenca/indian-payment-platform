# ğŸ§  å°åº¦æ”¯ä»˜å¹³å° - é¡¹ç›®è®°å¿†

## ğŸ¯ é¡¹ç›®æœ¬è´¨
- **å°åº¦æ¸¸æˆèšåˆæ”¯ä»˜å¹³å°** (rummy/teen patti)
- **Node.js + MongoDB + React** 
- **ç«¯å£**: 3000/3001 | **æ—¶åŒº**: Asia/Kolkata

## ğŸ’³ æ”¯ä»˜å•†çŠ¶æ€
- **PassPay** âœ… (ä¸»åŠ›) - ä»£æ”¶ä»£ä»˜ã€UTRã€UPIæŸ¥è¯¢ | æ–‡æ¡£è·¯å¾„: `/Users/kaka/Documents/QP/ZF/HX/PassPay`
- **DHPay** âœ… (åˆè§„å®Œæˆã€ç­¾åå·²ä¿®å¤) | æ–‡æ¡£è·¯å¾„: `/Users/kaka/Documents/QP/ZF/HX/DhPay` 
- **UnisPay** âœ… (éƒ¨ç½²å®Œæˆ) | æ–‡æ¡£è·¯å¾„: `/Users/kaka/Documents/QP/ZF/HX/UnisPay`
- **WakeUp** âœ…

## ğŸ”‘ æ ¸å¿ƒé…ç½®
```bash
# å¿…éœ€ç¯å¢ƒå˜é‡
MONGODB_URI=mongodb://localhost:27017/payment-platform
JWT_SECRET=your-jwt-secret
PASSPAY_MCHID/PAYID/SECRET=é…ç½®å€¼
PORT=3000
NODE_ENV=production
```

## ğŸŒ å…³é”®æ¥å£ (2025-09-12 æ›´æ–°)
### ğŸš€ **ç»Ÿä¸€æ”¯ä»˜æ¥å£** (æ–°)
```
POST /api/pay           # ç»Ÿä¸€æ”¯ä»˜æ¥å£ (æ”¯æŒåŸç”Ÿ+å”¤é†’)
  - pay_idç¼ºçœ/1: åŸç”ŸPassPayé€šé“
  - pay_id=2: å”¤é†’æ”¯ä»˜é€šé“
POST /api/query         # ç»Ÿä¸€è®¢å•æŸ¥è¯¢ (è‡ªåŠ¨è¯†åˆ«æ”¯ä»˜ç±»å‹)
POST /api/close         # è®¢å•å…³é—­
POST /api/utr/submit    # UTRè¡¥å• (æ”¯æŒä¸¤ç§ç±»å‹)
```

### ğŸ”„ **ä¸“ç”¨æ¥å£** (å…¼å®¹ä¿ç•™)
```
POST /api/wakeup/create # å”¤é†’æ”¯ä»˜ä¸“ç”¨æ¥å£
POST /api/wakeup/query  # å”¤é†’æ”¯ä»˜æŸ¥è¯¢
POST /api/payout/create # PassPayä»£ä»˜  
POST /api/balance/query # ä½™é¢æŸ¥è¯¢
```

## ğŸš€ æœåŠ¡å™¨æ¶æ„ & éƒ¨ç½²
### ğŸŒ AWSæœåŠ¡å™¨ä¿¡æ¯
- **æœåŠ¡å™¨IP**: `13.200.72.14`
- **SSHå¯†é’¥**: `/Users/kaka/AWS-Key/indian-payment-key-3.pem`
- **è¿æ¥å‘½ä»¤**: `ssh -i /Users/kaka/AWS-Key/indian-payment-key-3.pem ubuntu@13.200.72.14`
- **æ“ä½œç³»ç»Ÿ**: Ubuntu 22.04.5 LTS

### ğŸ”„ åŒç¯å¢ƒéƒ¨ç½²æ¶æ„
#### ğŸ§ª æµ‹è¯•ç¯å¢ƒ
- **åŸŸå**: https://test.cashgit.com
- **åº”ç”¨è·¯å¾„**: `/var/www/test.cashgit.com`
- **PM2åº”ç”¨å**: `test-indian-payment-platform` (ID: 0)
- **ç«¯å£**: 3000
- **ç”¨é€”**: è‡ªåŠ¨éƒ¨ç½²æµ‹è¯•ã€æ–°åŠŸèƒ½éªŒè¯

#### ğŸš€ ç”Ÿäº§ç¯å¢ƒ  
- **åŸŸå**: https://cashgit.com
- **åº”ç”¨è·¯å¾„**: `/var/www/cashgit.com`
- **PM2åº”ç”¨å**: `indian-payment-platform` (ID: 1)
- **ç«¯å£**: 3001
- **ç”¨é€”**: æ­£å¼çº¿ä¸ŠæœåŠ¡

### ğŸ“‹ éƒ¨ç½²æµç¨‹ âš ï¸ **ä¸¥æ ¼æ‰§è¡Œ**
1. **ä»£ç æ¨é€**: æœ¬åœ° â†’ GitHub â†’ **è‡ªåŠ¨éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ**
2. **æµ‹è¯•éªŒè¯**: åœ¨test.cashgit.coméªŒè¯åŠŸèƒ½
3. **ç”Ÿäº§éƒ¨ç½²**: **ç”¨æˆ·æ‰‹åŠ¨**æ‰§è¡Œ `deploy-production.sh` â†’ cashgit.com
4. **æœåŠ¡ç®¡ç†**: PM2ç®¡ç†ä¸¤ä¸ªç¯å¢ƒåŒæ—¶è¿è¡Œ

ğŸš¨ **é‡è¦è§„åˆ™**: 
- **ç¦æ­¢ç›´æ¥éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ** - åªèƒ½æ¨é€åˆ°GitHubè®©æµ‹è¯•ç¯å¢ƒè‡ªåŠ¨éƒ¨ç½²
- **ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²** - å¿…é¡»ç”±ç”¨æˆ·äº²è‡ªæµ‹è¯•åæ‰‹åŠ¨æ‰§è¡Œ
- **AIåŠ©æ‰‹èŒè´£** - åªèƒ½æäº¤ä»£ç åˆ°Gitï¼Œä¸èƒ½æ‰§è¡Œç”Ÿäº§éƒ¨ç½²å‘½ä»¤

### ğŸ”§ å…³é”®æ–‡ä»¶
- **PM2é…ç½®**: `ecosystem.config.js` (ç”Ÿäº§), `ecosystem.test.config.js` (æµ‹è¯•)
- **ç¯å¢ƒå˜é‡**: `env.production` (ç”Ÿäº§), æµ‹è¯•ç¯å¢ƒä½¿ç”¨é»˜è®¤é…ç½®
- **éƒ¨ç½²è„šæœ¬**: `deploy-production.sh`, `deploy-to-cashgit.sh`
- **GitHub Actions**: `.github/workflows/deploy-test.yml`

## âš ï¸ å¸¸è§é—®é¢˜ (2025-09ä¿®å¤)
1. **æ”¯ä»˜å¤±è´¥**: æ£€æŸ¥ç­¾åã€é…ç½®ã€ç½‘ç»œ
2. **çŠ¶æ€ä¸åŒæ­¥**: è°ƒç”¨æŸ¥è¯¢æ¥å£æ‰‹åŠ¨åŒæ­¥  
3. **å†…å­˜æ³„æ¼**: ä½¿ç”¨ `/api/memory-optimization`
4. âœ… **DhPayç­¾åé”™è¯¯** - å·²ä¿®å¤ç­¾åæ‹¼æ¥æ ¼å¼
5. âœ… **PassPayå›è°ƒæ ¼å¼** - å·²ä¿®å¤ä¸ºçº¯å­—ç¬¦ä¸²å“åº”
6. âœ… **é‡‘é¢æ ¼å¼ä¸ç»Ÿä¸€** - å·²ä¿®å¤å„æ”¯ä»˜å•†é‡‘é¢å¤„ç†
7. âœ… **çŠ¶æ€ç æ˜ å°„é”™è¯¯** - å·²ä¿®å¤PassPayçŠ¶æ€æ˜ å°„
8. âœ… **æ•°æ®åº“é‡‘é¢å•ä½ä¸ä¸€è‡´** - å·²ä¿®å¤paisa/rupeesè½¬æ¢
9. âœ… **å›è°ƒé‡‘é¢è§£æé”™è¯¯** - å·²ä¿®å¤webhooké‡‘é¢å¤„ç†
10. âœ… **é‡å¤çŠ¶æ€æ˜ å°„å‡½æ•°å†²çª** - å·²ç»Ÿä¸€æ‰€æœ‰çŠ¶æ€æ˜ å°„
11. âœ… **adminæƒé™é—®é¢˜** - å·²ä¿®å¤å‰ç«¯ç¼ºå¤±SYSTEM_MONITORINGæƒé™ (2025-09-11)
12. âœ… **å‰åç«¯çŠ¶æ€ä¸ä¸€è‡´** - å·²ç»Ÿä¸€ä½¿ç”¨å¤§å†™çŠ¶æ€å€¼ACTIVE/INACTIVE (2025-09-12)
13. âœ… **æ”¯ä»˜è´¦æˆ·å…³é—­éªŒè¯å¤±è´¥** - å·²ä¿®å¤secretKeyæ¡ä»¶éªŒè¯ (2025-09-12)
14. âœ… **ç”¨æˆ·ç®¡ç†çŠ¶æ€éªŒè¯é”™è¯¯** - å·²ä¿®å¤APIéªŒè¯å™¨çŠ¶æ€æšä¸¾ (2025-09-12)

## ğŸš€ **æ–°åŠŸèƒ½** (2025-09-12)
### ğŸ’³ **ç»Ÿä¸€æ”¯ä»˜æ¥å£**
- **åŒé€šé“æ”¯æŒ**: ä¸€ä¸ªæ¥å£æ”¯æŒåŸç”ŸPassPay + å”¤é†’æ”¯ä»˜
- **æ™ºèƒ½è·¯ç”±**: é€šè¿‡pay_idå‚æ•°è‡ªåŠ¨é€‰æ‹©æ”¯ä»˜ç±»å‹
  - `pay_id` ç¼ºçœæˆ– = 1 â†’ åŸç”ŸPassPayé€šé“ (ç›´è¿)
  - `pay_id = 2` â†’ å”¤é†’æ”¯ä»˜é€šé“ (DhPayä¸Šæ¸¸)
- **å‘åå…¼å®¹**: ç°æœ‰å•†æˆ·æ— éœ€ä¿®æ”¹ä»£ç 
- **ç»Ÿä¸€ç®¡ç†**: æŸ¥è¯¢ã€å…³é—­ã€UTRè¡¥å•è‡ªåŠ¨è¯†åˆ«è®¢å•ç±»å‹

## ğŸ“‹ é‡è¦æ–‡æ¡£
- `PASSPAY_INTEGRATION_README.md` - PassPayå®Œæ•´æŒ‡å—
- `deployment-workflow.md` - éƒ¨ç½²æµç¨‹
- `Indian-Payment-Platform-API.postman_collection.json` - APIæµ‹è¯•

## ğŸ”§ å¼€å‘é€ŸæŸ¥
```bash
npm run dev      # å¼€å‘æ¨¡å¼
npm start        # ç”Ÿäº§æ¨¡å¼
pm2 restart all  # é‡å¯æœåŠ¡
```

## ğŸ“¡ **APIä½¿ç”¨ç¤ºä¾‹** (2025-09-12 æ–°å¢)
### ğŸš€ **ç»Ÿä¸€æ”¯ä»˜æ¥å£**
```javascript
// åŸç”Ÿæ”¯ä»˜ (é»˜è®¤)
POST /api/pay
{
  "appid": "merchant_appid",
  "orderid": "ORDER_001", 
  "amount": "100.00",
  "desc": "æ¸¸æˆå……å€¼",
  "notify_url": "https://merchant.com/notify",
  "sign": "calculated_md5_signature"
}

// å”¤é†’æ”¯ä»˜
POST /api/pay  
{
  "appid": "merchant_appid",
  "orderid": "ORDER_002",
  "amount": "200.00", 
  "desc": "æ¸¸æˆå……å€¼",
  "pay_id": "2",                    // å…³é”®: æŒ‡å®šå”¤é†’æ”¯ä»˜
  "customer_phone": "1234567890",   // å”¤é†’æ”¯ä»˜å¿…éœ€
  "notify_url": "https://merchant.com/notify",
  "sign": "calculated_md5_signature"
}

// ç»Ÿä¸€æŸ¥è¯¢ (è‡ªåŠ¨è¯†åˆ«è®¢å•ç±»å‹)
POST /api/query
{
  "appid": "merchant_appid",
  "orderid": "ORDER_001",
  "sign": "calculated_md5_signature"
}
```

## ğŸ”’ ç­¾åç®—æ³•è¦ç‚¹
- **PassPay**: MD5åŠ å¯†è½¬å°å†™ï¼Œ`&key={secretKey}`
- **DHPay**: MD5åŠ å¯†è½¬å¤§å†™ï¼Œ`&secretKey={secretKey}` âš ï¸
- **UnisPay**: SHA256åŠ å¯†è½¬å°å†™ï¼Œ`&key={secretKey}`

## ğŸ’° é‡‘é¢æ ¼å¼è¦æ±‚
- **æ•°æ®åº“å­˜å‚¨**: ç»Ÿä¸€ä½¿ç”¨paisaä¸ºå•ä½ (æ•´æ•°)
- **APIä¼ è¾“**: æ ¹æ®æ”¯ä»˜å•†è¦æ±‚æ ¼å¼åŒ–
  - **PassPay**: å­—ç¬¦ä¸²æ ¼å¼ï¼Œä¿ç•™2ä½å°æ•° `"100.00"`
  - **DHPay**: æ•´æ•°æ ¼å¼ï¼Œå•ä½ä¸ºåˆ† `10000`
  - **UnisPay**: å­—ç¬¦ä¸²æ ¼å¼ï¼Œç›´æ¥ä½¿ç”¨å¢æ¯”
- **å†…éƒ¨è½¬æ¢**: 
  - å­˜å‚¨æ—¶: `Math.round(rupees * 100)` â†’ paisa
  - æ˜¾ç¤ºæ—¶: `(paisa / 100).toFixed(2)` â†’ rupees

## ğŸ® æ•°æ®åº“ç”¨æˆ·ç®¡ç†
### ğŸ‘¥ ç”Ÿäº§ç¯å¢ƒç”¨æˆ· (payment-platformæ•°æ®åº“)
- **ç®¡ç†å‘˜**: `admin` (ç³»ç»Ÿç®¡ç†å‘˜) - å®Œæ•´æƒé™
- **å•†æˆ·**: `cgpay` - å•†æˆ·æƒé™ (merchantId: cgpay)
- **æŸ¥è¯¢æ–¹å¼**: 
  ```bash
  # SSHè¿æ¥æœåŠ¡å™¨
  ssh -i /Users/kaka/AWS-Key/indian-payment-key-3.pem ubuntu@13.200.72.14
  
  # è¿›å…¥MongoDB
  mongosh
  use payment-platform
  db.users.find({})
  ```

## ğŸ”§ æœåŠ¡å™¨è¿ç»´
### PM2æœåŠ¡ç®¡ç†
```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡
pm2 list

# é‡å¯ç”Ÿäº§ç¯å¢ƒ
pm2 restart indian-payment-platform

# é‡å¯æµ‹è¯•ç¯å¢ƒ  
pm2 restart test-indian-payment-platform

# æŸ¥çœ‹æ—¥å¿—
pm2 logs indian-payment-platform --lines 20
pm2 logs test-indian-payment-platform --lines 20

# åœæ­¢/å¯åŠ¨æœåŠ¡
pm2 stop 1    # åœæ­¢ç”Ÿäº§ç¯å¢ƒ
pm2 start 1   # å¯åŠ¨ç”Ÿäº§ç¯å¢ƒ
```

### ğŸ” æ•…éšœæ’æŸ¥
1. **502é”™è¯¯**: æ£€æŸ¥PM2æœåŠ¡æ˜¯å¦è¿è¡Œ
2. **æœåŠ¡åœæ­¢**: ä½¿ç”¨ `pm2 start ecosystem.config.js --env production`
3. **æ•°æ®åº“è¿æ¥**: ç¡®è®¤MongoDBæœåŠ¡è¿è¡Œ `sudo systemctl status mongod`
4. **ç«¯å£å†²çª**: æ£€æŸ¥ç«¯å£å ç”¨ `netstat -tlnp | grep 3001`

---
**âš¡ è®°ä½** (2025-09-12 æ›´æ–°): 
- ç»Ÿä¸€æ”¯ä»˜æ¥å£å·²ä¸Šçº¿ï¼šä¸€ä¸ª/api/payæ¥å£æ”¯æŒä¸¤ç§æ”¯ä»˜ç±»å‹
- pay_idå‚æ•°æ§åˆ¶è·¯ç”±ï¼š1=æ ‡å‡†æ”¯ä»˜ï¼Œ2=å”¤é†’æ”¯ä»˜
- å‘ä¸‹æ¸¸å•†æˆ·æ¨èä½¿ç”¨ç»Ÿä¸€æ¥å£ï¼Œç®€åŒ–é›†æˆå¤æ‚åº¦
- **CashGitç»Ÿä¸€æ”¯ä»˜æ–‡æ¡£**ï¼šå·²æ›´æ–°å®Œæ•´çš„å¯¹æ¥æ–‡æ¡£
- ä¸¤ä¸ªç¯å¢ƒåŒæ—¶è¿è¡Œï¼Œäº’ä¸å½±å“
- **ä¸¥æ ¼éƒ¨ç½²æµç¨‹**ï¼šæµ‹è¯•ç¯å¢ƒè‡ªåŠ¨éƒ¨ç½²ï¼Œç”Ÿäº§ç¯å¢ƒç”¨æˆ·æ‰‹åŠ¨éƒ¨ç½²
- **AIä¸å¯ç›´æ¥æ“ä½œç”Ÿäº§ç¯å¢ƒ** - åªèƒ½æ¨é€åˆ°Git
- æ‰€æœ‰APIéƒ½éœ€è¦ç­¾åéªŒè¯ï¼Œç”Ÿäº§ç¯å¢ƒå¿…é¡»HTTPS
- æœåŠ¡å™¨é‡å¯åéœ€è¦æ‰‹åŠ¨å¯åŠ¨PM2æœåŠ¡
- ç³»ç»Ÿå·²å‡†å¤‡æ‰¿æ¥30ä¸‡å¢æ¯”/å°æ—¶çš„è®¢å•é‡ ğŸš€